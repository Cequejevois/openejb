
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
 <HEAD>
  <!-- $PAGETITLE -->
  <TITLE>OpenEJB - Configuration</TITLE>
  <LINK href="http://people.apache.org/~dblevins/openejb/default.css" rel="stylesheet" type="text/css">
  <LINK href="http://people.apache.org/~dblevins/openejb/style.css" rel="stylesheet" type="text/css">
  <LINK rel="SHORTCUT ICON" href="http://incubator.apache.org/openejb/images/favicon.ico">
  <SCRIPT language="JavaScript" src="http://cwiki.apache.org/confluence/pages/viewpage.action?spaceKey=OPENEJB&title=functions.js" type="text/javascript"></SCRIPT>
 <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY bgcolor="#ffffff" link="#6763a9" vlink="#6763a9" topmargin="0" bottommargin="0" leftmargin="0" marginheight="0" marginwidth="0">
  <A name="top"></A>
  <TABLE border="0" cellpadding="0" cellspacing="0" width="100%" height="400">
   <TR>
    <TD width="20" valign="top" align="left" bgcolor="#7270c2"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="1" border="0"></TD>
    <TD width="95" valign="top" align="left" bgcolor="#7270c2"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="1" border="0"></TD>
    <TD width="7" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" border="0" width="1" height="1"></TD>
    <TD width="40" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="40" height="6" border="0"></TD>
    <TD width="100%" valign="top" align="left" bgcolor="#5A5CB8"><IMG src="http://incubator.apache.org/openejb/images/top_2.gif" width="430" height="6" border="0"></TD>
    <TD width="120" valign="top" align="left" bgcolor="#E24717"><IMG src="http://incubator.apache.org/openejb/images/top_3.gif" width="120" height="6" border="0"></TD>
   </TR>
   <TR>
    <TD width="20" bgcolor="#7270c2" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" border="0" width="1" height="1"></TD>
    <TD width="95" bgcolor="#7270c2" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" border="0" width="1" height="1"></TD>
    <TD width="7" bgcolor="#ffffff" valign="top" align="left"></TD>
    <TD width="40" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="1" border="0"></TD>
    <TD id="breadcrumbs" width="100%" valign="middle" align="left">
      <!-- $TOP_NAV_BAR -->
      <SPAN id="Content">
        
            
                                                                                                                                                                                    
                                    
                                                
            <A href="index.html" title="Index">Index</A> | <A href="news.html" title="News">News</A> | <A href="faq.html" title="FAQ">FAQ</A> | <A href="download.html" title="Download">Download</A> | <A href="mailing-lists.html" title="Mailing Lists">Lists</A> | <SPAN class="nobr"><A href="http://issues.apache.org/jira/browse/OPENEJB" title="Visit page outside Confluence" rel="nofollow">Issues<SUP><IMG class="rendericon" src="http://cwiki.apache.org/confluence/images/icons/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"></SUP></A></SPAN>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </SPAN>
     <IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="2" border="0"></TD>
    <TD width="120" height="20" valign="top" align="left">&nbsp;</TD>
   </TR>
   <TR>
    <TD width="20" bgcolor="#7270c2" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="20" height="3" border="0"></TD>
    <TD width="95" bgcolor="#7270c2" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/line_sm.gif" width="105" height="3" border="0"></TD>
    <TD width="7" bgcolor="#a9a5de" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/line_sm.gif" width="7" height="3" border="0"></TD>
    <TD width="40" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/line_light.gif" width="40" height="3" border="0"></TD>
    <TD width="100%" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/line_light.gif" width="430" height="3" border="0"></TD>
    <TD width="120" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" border="0" width="1" height="1"></TD>
   </TR>
   <TR>
    <TD bgcolor="#7270c2" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="20" height="10" border="0"></TD>
    <TD id="leftColumn" valign="top" style="padding-top: 0px;">
    <SPAN id="Content">
      
            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                    
                                                
            <H3><A name="Navigation-Overview"></A>Overview</H3>
<UL class="alternate" type="square">
	<LI><A href="index.html" title="Index">Home</A></LI>
	<LI><A href="news.html" title="News">News</A></LI>
	<LI><A href="faq.html" title="FAQ">FAQ</A></LI>
	<LI><A href="download.html" title="Download">Download</A></LI>
	<LI><A href="quickstart.html" title="Quickstart">Quickstart</A></LI>
	<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
	<LI><A href="source-code.html" title="Source Code">Source Code</A></LI>
</UL>


<H3><A name="Navigation-General"></A>General</H3>
<UL class="alternate" type="square">
	<LI><A href="deploy-tool.html" title="Deploy Tool">Deployment</A></LI>
	<LI><A href="startup.html" title="Startup">Startup</A></LI>
	<LI><A href="validation-tool.html" title="Validation Tool">Validation</A></LI>
	<LI><A href="webadmin.html" title="Webadmin">Webadmin</A></LI>
</UL>


<H3><A name="Navigation-Configuration"></A>Configuration</H3>
<UL class="alternate" type="square">
	<LI><A href="" title="Configuration">General</A></LI>
	<LI><A href="deployments.html" title="Deployments">Deployments</A></LI>
	<LI><A href="containers.html" title="Containers">Containers</A></LI>
	<LI><A href="castor-cmp.html" title="Castor CMP">Castor CMP</A></LI>
</UL>


<H3><A name="Navigation-Servers"></A>Servers</H3>
<UL class="alternate" type="square">
	<LI><A href="local-server.html" title="Local Server">Local</A></LI>
	<LI><A href="remote-server.html" title="Remote Server">Remote</A></LI>
</UL>



<H3><A name="Navigation-Integrations"></A>Integrations</H3>
<UL class="alternate" type="square">
	<LI><A href="tomcat.html" title="Tomcat">Tomcat</A></LI>
	<LI><A href="geronimo.html" title="Geronimo">Geronimo</A></LI>
	<LI><A href="webobjects.html" title="WebObjects">WebObjects</A></LI>
</UL>


<H3><A name="Navigation-Community"></A>Community</H3>
<UL class="alternate" type="square">
	<LI><A href="team.html" title="Team">Team</A></LI>
	<LI><A href="help.html" title="Help">Help</A></LI>
	<LI><A href="articles.html" title="Articles">Articles</A></LI>
	<LI><A href="annoyances.html" title="Annoyances">Annoyances</A></LI>
</UL>
                                                                                                                                                                                                                </SPAN>

            <H3 class="heading3">Feeds</H3>
            <TABLE border="0" cellspacing="4px">
            <TR>
              <TD align="right">
                <A href="http://cwiki.apache.org/confluence/spaces/rss.action?key=OPENEJB&newPages=false"><IMG src="http://incubator.apache.org/openejb/images/rss.gif" border="0"></A><BR>
              </TD>
              <TD align="left">
                <A href="http://cwiki.apache.org/confluence/spaces/rss.action?key=OPENEJB&newPages=false">Site</A>
              </TD>
            </TR>
            <TR>
              <TD align="right">
                <A href="http://cwiki.apache.org/confluence/spaces/blogrss.action?key=OPENEJB"><IMG src="http://incubator.apache.org/openejb/images/rss.gif" border="0"></A>
              </TD>
              <TD align="left">
                <A href="http://cwiki.apache.org/confluence/spaces/blogrss.action?key=OPENEJB">News</A>
              </TD>
            </TR>
            </TABLE>
        </TD>
    <TD width="7" bgcolor="#a9a5de" valign="top" align="left">&nbsp;</TD>
    <TD width="40" valign="top" align="left">&nbsp;</TD>
    <TD rowspan="4" width="100%" valign="top">
     <TABLE cols="1" rows="2" border="0" cellpadding="0" cellspacing="0" width="100%">
      <TR>
       <TD valign="top" align="left"><BR>
          <TABLE cols="3" rows="1" border="0" cellpadding="0" cellspacing="0" width="100%">
          <TR>
           <TD valign="top" width="200" align="left">
           <A href="http://openejb.org/">
           <IMG border="0" hspace="0" src="http://incubator.apache.org/openejb/images/logo_openejb.gif" vspace="0">
           </A>
           </TD>
           <TD align="right" valign="middle" style="padding:0px;margin:0px;">
	      <TABLE style="padding:0px;margin:0px;">
            <TR>
                <TD>
	            <A href="http://incubator.apache.org/">
	              <IMG src="http://incubator.apache.org/images/apache-incubator-logo.png" border="0">
	            </A>
                </TD>
            <TR>
<!--
	        <tr>
	            <td align="right" valign="top" style="font- size:12px;color:#777777">
	            [OpenEJB is a Podling in the Apache Incubator]
	            </td>
	        </tr>
-->
          </TABLE>
           </TD>
          </TR>
          </TABLE>
	<BR>
      </TD>
      </TR>
      <TR>
       <TD valign="top" align="left">
         <IMG border="0" height="7" hspace="0" src="http://incubator.apache.org/openejb/images/dotTrans.gif"><BR>
          <DIV id="page_title">
            <TABLE width="100%">
              <TR>
                <TD>
	<!-- $TITLE -->
	Configuration
                </TD>
                 <TD align="right" style="padding-left:0px;"><A style="color:#999;font-size:small;font-weight:normal;" href="http://cwiki.apache.org/confluence/pages/editpage.action?spaceKey=OPENEJB&title=Configuration">[ edit ]</A></TD>
                <TD align="right" width="25">

            <SCRIPT type="text/javascript" language="javascript">
                document.write('<a href="http://cwiki.apache.org/confluence/pages/viewpage');
                document.write('.action?pageId=26496&decorator=printable">');
            </SCRIPT>
            <IMG src="http://cwiki.apache.org/confluence/images/icons/print_16.gif" height="16" width="16" border="0" align="absmiddle" title="Print"></A>

                </TD>
              </TR>
            </TABLE>
          </DIV>
        <IMG border="0" height="1" hspace="0" src="http://incubator.apache.org/openejb/images/dotTrans.gif"></TD>
      </TR>
     </TABLE>
     <P>
     <!-- $BODY -->
            <DIV id="PageContent">
        
        <DIV class="pagecontent">
            <DIV class="wiki-content">
                
<H1><A name="Configuration-ShortOverview"></A>Short Overview</H1>

<H2><A name="Configuration-ConfigurationProperties"></A>Configuration Properties</H2>

<UL>
	<LI><B>openejb.home</B> - OpenEJB home (installation) directory path. All relative paths are resolved against the property unless openejb.base is set. Unless set, the value is assigned to the <EM>user.dir</EM> Java property.</LI>
	<LI><B>openejb.base</B> - OpenEJB base directory path. If set, the directory pointed by the property is searched for resources before openejb.home.</LI>
	<LI><B>openejb.configuration</B> - OpenEJB configuration file path.</LI>
	<LI><B>openejb.loader</B> - OpenEJB loader that&apos;s responsible for loading EJBs. There are 3 different loader types:
	<UL>
		<LI><B>tomcat-webapp</B> - set it when inside of Tomcat scoped at just the webapp, aka. <A href="collapsed-ear.html" title="Collapsed EAR">Collapsed EAR</A></LI>
		<LI><B>tomcat</B> - set it when inside of Tomcat scoped for all webapps to share</LI>
		<LI><B>system</B> (also: bootstrap)</LI>
		<LI><B>embedded</B> (also: noload)</LI>
	</UL>
	</LI>
	<LI><B>openejb.configurator</B> (default: <EM>org.openejb.alt.config.ConfigurationFactory</EM> ) - a class that builds org.openejb.alt.assembler.classic.OpenEjbConfiguration object; implements the org.openejb.alt.assembler.classic.OpenEjbConfigurationFactory interface</LI>
</UL>


<H2><A name="Configuration-ConfigurationFile"></A>Configuration File</H2>

<P>Show a config file with the elements hyperlinked.</P>

<DIV class="code"><DIV class="codeHeader"><B>openejb.conf</B></DIV><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN>?&gt;</SPAN>
<SPAN class="code-tag">&lt;openejb&gt;</SPAN>
  <SPAN class="code-tag">&lt;Container id=<SPAN class="code-quote">&quot;Default CMP Container&quot;</SPAN> ctype=<SPAN class="code-quote">&quot;CMP_ENTITY&quot;</SPAN>&gt;</SPAN>
    Global_TX_Database  c:/my/app/conf/postgresql.cmp_global_database.xml
    Local_TX_Database   c:/my/app/conf/postgresql.cmp_local_database.xml
  <SPAN class="code-tag">&lt;/Container&gt;</SPAN>
  <SPAN class="code-tag">&lt;Connector id=<SPAN class="code-quote">&quot;Default JDBC Database&quot;</SPAN>&gt;</SPAN>
    JdbcDriver org.postgresql.Driver
    JdbcUrl jdbc:postgresql://localhost/mydb
    UserName username
    Password password
  <SPAN class="code-tag">&lt;/Connector&gt;</SPAN>
  <SPAN class="code-tag">&lt;SecurityService id=<SPAN class="code-quote">&quot;Default Security Service&quot;</SPAN>/&gt;</SPAN>
  <SPAN class="code-tag">&lt;TransactionService id=<SPAN class="code-quote">&quot;Default Transaction Manager&quot;</SPAN>/&gt;</SPAN>
  <SPAN class="code-tag">&lt;Deployments jar=<SPAN class="code-quote">&quot;c:/my/app/employee.jar&quot;</SPAN>/&gt;</SPAN>
  <SPAN class="code-tag">&lt;Deployments dir=<SPAN class="code-quote">&quot;beans/&quot;</SPAN> /&gt;</SPAN>
<SPAN class="code-tag">&lt;/openejb&gt;</SPAN></PRE>
</DIV></DIV>

<H1><A name="Configuration-BasicLayout"></A>Basic Layout</H1>

<P>Basically, openejb.base is the source for 100% of all configuration information and third party config files (log4j, castor, instantdb, whatever).  This includes finding where the, possibly many, &lt;Deployment&gt; entries in the openejb.conf point.  The openejb.home is where the code loading OpenEJB will look for all the OpenEJB libraries.  Usually openejb.base is not explicitly set and defaults to the value of openejb.home, so many people are used to only dealing with openejb.home.</P>

<P>The point of having and openejb.base and openejb.home was basically to allow several independently configured instances of OpenEJB running on a system (perhaps embedded in Swing apps, in Tomcat, running as a standalone Server, or even in Groovy as Mr. Strachan did!) but without the need to copy all the OpenEJB system libraries everywhere.</P>

<P><B>openejb.home</B> </P>
<UL>
	<LI>can be set explicitly via a system property.</LI>
	<LI>if not set it default&apos;s to user.dir, which is the current working directory.</LI>
</UL>


<P><B>openejb.base</B></P>
<UL>
	<LI>can be set explicitly via a system property.</LI>
	<LI>If not set it default&apos;s to openejb.home.</LI>
</UL>


<P><B>openejb.configuration</B></P>
<UL>
	<LI>can be set to explicitly point to the file containing your configuration.</LI>
	<LI>If set to a relative path, we first look in user.dir/your-conf-file, then in openejb.base/your-conf-file</LI>
	<LI>If not set we check in openejb.base/conf/openejb.conf</LI>
	<LI>If no conf file is found, we create one in openejb.base/conf/openejb.conf</LI>
</UL>



<P><B>relative paths in openejb.conf</B></P>
<UL>
	<LI>Deployment entries are resolved relative to openejb.base.</LI>
	<LI>Containers use openejb.base to resolve their own config files.  For example, Castor JDO to loads the database.xml and all other files from the openejb.base directory.</LI>
	<LI>Resource adapters that are embedded usually have config files of their own and are also loaded from the openeb.base.</LI>
</UL>


<P><B>log files</B></P>
<UL>
	<LI>The log4.configuration file is resolved relative to openejb.base.</LI>
	<LI>The properties in the config file that point to files are also resolved relative to openejb.base.</LI>
</UL>


<P><B>OpenEJB libraries</B></P>
<UL>
	<LI>The jars in the lib and dist directories under openejb.home are added to the classpath.</LI>
</UL>


<H2><A name="Configuration-Summary"></A>Summary</H2>

<P>A summary of the above in a different notation:</P>

<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>openejb.home = user.dir (can be set explicitly)
openejb.base = openejb.home (can be set explicitly)
openejb.conf = openejb.base/conf/openejb.conf (can be set explicitly)
logging.conf = openejb.base/conf/logging.conf (can be set explicitly)
deployments  = paths listed in openejb.conf (relative paths resolved from openejb.base)
Classpath includes openejb.home/lib and openejb.home/dist
</PRE>
</DIV></DIV>

<H2><A name="Configuration-Examplelayout"></A>Example layout</H2>

<P>In this one the openejb.home and openejb.base are set, everything else is defaulted.  The openejb.conf file as been updated to point to the ejb jars by name (abc-ejbs.jar and xyz-ejbs.jar).</P>

<P>An example layout:</P>
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>/usr/local/openejb  (openejb.home)
/usr/local/openejb/lib  (in classpath)
/usr/local/openejb/dist (in classpath)
/home/jsmith/foo_app  (openejb.base)
/home/jsmith/foo_app/conf/openejb.conf
/home/jsmith/foo_app/conf/logging.conf
/home/jsmith/foo_app/abc-ejbs.jar (Deployment entry in openejb.conf)
/home/jsmith/foo_app/xyz-ejbs.jar (Deployment entry in openejb.conf)
/home/jsmith/foo_app/logs/  
</PRE>
</DIV></DIV>


<H2><A name="Configuration-AnotherExamplelayout"></A>Another Example layout</H2>

<P>In this example openejb.home and openejb.base are setup as well as the explicit paths for the openejb and log4j configuration files.</P>

<P>An example layout:</P>
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>/usr/local/openejb  (openejb.home)
/usr/local/openejb/lib  (in classpath)
/usr/local/openejb/dist (in classpath)
/home/jsmith/foo_app  (openejb.base)
/home/jsmith/foo_app/openejb.xml  (openejb.configuration)
/home/jsmith/foo_app/abc-ejbs.jar (Deployment entry in openejb.xml)
/home/jsmith/foo_app/xyz-ejbs.jar (Deployment entry in openejb.xml)
/home/jsmith/foo_app/log4j.conf  (log4j.configuration)
/home/jsmith/foo_app/mylogs/  (logging dir as defined in log4j.conf)
</PRE>
</DIV></DIV>
            </DIV>
        </DIV>
    </DIV>
     </P>
    </TD>
<!--    <td width="120" height="5" valign="top" align="left"></td>   -->

   </TR>
   <TR height="5">
    <TD width="20" height="5" bgcolor="#7270c2" valign="top" align="left">&nbsp;</TD>
    <TD width="95" height="5" bgcolor="#7270c2" valign="top">&nbsp;</TD>
    <TD width="7" height="5" bgcolor="#a9a5de" valign="top" align="left">&nbsp;</TD>
    <TD width="40" height="5" valign="top" align="left">&nbsp;</TD>
    <TD width="120" height="5" valign="top" align="left">&nbsp;</TD>
   </TR>
   <TR>
    <TD width="20" height="5" bgcolor="#7270c2" valign="top" align="left">&nbsp;</TD>
    <TD width="95" bgcolor="#7270c2" valign="BOTTOM" align="left">&nbsp;</TD>
    <TD width="7" bgcolor="#a9a5de" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="25" border="0"></TD>
    <TD width="40" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="25" border="0"></TD>
    <TD width="120" valign="top" align="left">&nbsp;</TD>
   </TR>
   <TR>
    <TD width="20" height="5" bgcolor="#7270c2" valign="top" align="left">&nbsp;</TD>
    <TD width="95" bgcolor="#7270c2" valign="BOTTOM" align="left">&nbsp;</TD>
    <TD width="7" bgcolor="#a9a5de" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="25" border="0"></TD>
    <TD width="40" valign="top" align="left"><IMG src="http://incubator.apache.org/openejb/images/dotTrans.gif" width="1" height="25" border="0"></TD>
    <TD width="120" valign="top" align="left">&nbsp;</TD>
   </TR>
   <TR height="5">
    <TD width="20" rowspan="2" height="100%" bgcolor="#7270c2" valign="bottom" align="left"><IMG src="http://incubator.apache.org/openejb/images/stripes1.gif" width="20" height="125" border="0"></TD>
    <TD width="95" rowspan="2" height="100%" bgcolor="#7270c2" valign="bottom" align="left"><IMG src="http://incubator.apache.org/openejb/images/stripe105.gif" width="105" height="125" border="0"></TD>
    <TD width="7" rowspan="2" height="100%" bgcolor="#a9a5de" valign="top" align="left">&nbsp;</TD>
    <TD width="40" height="100%" valign="top" align="left">&nbsp;</TD>
    <TD width="120" height="100%" valign="top" align="left">&nbsp;</TD>
   </TR>
   <TR height="5">
    <TD width="40" height="25" valign="top" align="left">&nbsp;</TD>
    <TD width="100%" height="25" valign="bottom" align="left"><BR>
     <BR>
     <IMG src="http://incubator.apache.org/openejb/images/line_light.gif" border="0" width="430" height="3"><BR>
     <P>
     </P>
     <SPAN class="bodyGrey">
     <SMALL><NOTICE><!-- $FOOTER -->
Apache OpenEJB is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Geronimo PMC. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
     </NOTICE> <BR>
     &nbsp;<BR>
          Powered by <A href="http://atlassian.com/">Atlassian</A> <A href="http://atlassian.com/confluence/">Confluence</A>.
     </SMALL>
     </SPAN>
     <P>
     </P>
     </TD>
    <TD width="120" height="25" valign="top" align="left">&nbsp;</TD>
   </TR>
  </TABLE>
  </BODY>
 </HTML>
